<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gada.travelgada.mapper.BoardMapper"> 

<!-- < 	<select id="selectReviewBoard" resultType="com.gada.travelgada.domain.BoardVO">
		<![CDATA[
			select * from board where board_type_id = 1
		]]>
	</select> 
	
	<select id="selectQnABoard" resultType="com.gada.travelgada.domain.BoardVO">
		<![CDATA[
			select * from board where board_type_id = 2
		]]>
	</select>
	
	<select id="selectAccompanyBoard" resultType="com.gada.travelgada.domain.BoardVO">
		<![CDATA[
			select * from board where board_type_id = 3
		]]>
	</select>
	
	<select id="selectAnnouncementBoard" resultType="com.gada.travelgada.domain.BoardVO">
		<![CDATA[
			select * from board where board_type_id = 4
		]]>
	</select> -->
	
	
  	<resultMap id="authMap" type="com.gada.travelgada.domain.AuthVO">
		<result property="member_id" column="member_id"/>
		<result property="authority" column="authority"/>
	</resultMap>
	
    <resultMap id="BoardMap" type="com.gada.travelgada.domain.BoardVO">
       <result property="board_id" column="board_id"/>
       <result property="title" column="title"/>
       <result property="text" column="text"/>
       <result property="board_date" column="board_date"/>
       <result property="bhit" column="bhit"/>
       <result property="bgroup" column="bgroup"/>
       <result property="bstep" column="bstep"/>
       <result property="bindent" column="bindent"/>
       <result property="board_type_id" column="board_type_id"/>     
       <result property="member_id" column="member_id"/>
   </resultMap>
   
   <resultMap id="MemberMap" type="com.gada.travelgada.domain.MemberVO">
      <result property="member_id" column="member_id"/>
      <result property="pw" column="pw"/>
      <result property="member_name" column="member_name"/>
      <result property="email" column="email"/>
      <result property="phone_num" column="phone_num"/>
      <result property="profile_img_path" column="profile_img_path"/>
      <result property="withdrawal_flag" column="withdrawal_flag"/>
      <result property="withdrawal_code" column="withdrawal_code"/>
      <result property="sns_type" column="sns_type"/>
      <collection property="authList" resultMap="authMap"></collection>
      <collection property="boardList" resultMap="BoardMap"></collection>
   </resultMap> 
   

	
	<select id="selectReviewBoard" resultMap="BoardMap">
		<![CDATA[
			select B1.* FROM( SELECT * FROM board where board_type_id = 1 order by bgroup desc, bstep asc ) B1 LIMIT #{nowPage}, #{amount}
		]]>
	</select>

	<select id="getTotalReviewBoard" resultType="int">
		<![CDATA[
			select count(*) from board where board_type_id = 1
		]]>
	</select>
	
	<select id="selectQnABoard" resultMap="BoardMap">
		<![CDATA[
			select B2.* FROM( SELECT * FROM board where board_type_id = 2 order by bgroup desc, bstep asc ) B2 LIMIT #{nowPage}, #{amount} 		
		]]>
	</select>

	<select id="getTotalQnABoard" resultType="int">
		<![CDATA[
			select count(*) from board where board_type_id = 2
		]]>
	</select>	
	
	<select id="getAccompanyBoard" resultMap="BoardMap">
		<![CDATA[
			select B3.* FROM( SELECT * FROM board where board_type_id = 3 order by bgroup desc, bstep asc, board_date desc ) B3 LIMIT #{nowPage}, #{amount} 		
		]]>
	</select>

	<select id="getTotalAccompanyBoard" resultType="int">
		<![CDATA[
			select count(*) from board where board_type_id = 3
		]]>
	</select>	
	
	
	<select id="getNotice" resultMap="BoardMap">
		<![CDATA[
			 		
			select * from (select * from board where board_type_id = 4) a order by a.board_id desc
		]]>
	</select>

	<select id="boardContentView" resultMap="BoardMap">
		<![CDATA[
			
			select * from board where board_id = #{board_id}
		]]>
	</select>
	
	<update id="addHit">
		<![CDATA[
			update board set bhit = bhit + 1 where board_id = #{board_id}
		]]>
	</update>
			
	<select id="boardImgPath" resultMap="MemberMap">
		<![CDATA[
			
			select * from member where member_id = #{member_id}
		]]>
	</select>
	
	<insert id="writeBoard"> 
		<![CDATA[ 
			insert into board (board_id, title, text, board_date, bhit, bgroup, bstep, bindent, board_type_id, member_id)
			values (get_seq('board_seq'), #{title}, #{text}, sysdate(), 0, get_seq('bgroup_seq'), 0, 0, #{board_type_id}, #{member_id})
		]]> 
	</insert> 

</mapper>
